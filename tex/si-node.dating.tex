\documentclass[12pt]{article}

\usepackage[margin=2cm]{geometry}
\usepackage{colortbl}
\usepackage{mathptmx}
\usepackage{nicefrac}
\usepackage{authblk}
\usepackage{array}

\usepackage{times}
\usepackage[round]{natbib}
\makeatletter
\renewcommand{\@biblabel}[1]{#1.}
\makeatother

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{xcolor}


\newcommand{\code}[1]{{\tt #1}}
 
\begin{document}

\title{Supplementary Information // node.dating: Timing the nodes of ancestral dates in phylogenetic trees}

\author[1,2]{Bradley R. Jones}
\author[1,2,*]{Bradley R. Jones}
\author[2,3]{Art F.Y. Poon}
\affil[1]{Faculty of Health Sciences, Simon Fraser University, Burnaby, V5A 1S6, Canada}%, Burnaby, Canada}
\affil[2]{BC Centre for Excellence in HIV/AIDS, Vancouver, V6Z 1Y6, Canada}
\affil[3]{Department of Medicine, University of British Columbia, V5Z 1M9, Canada}%, Vancouver, Canada}
\affil[*]{Corresponding author (email: brj1@sfu.ca)}

\date{}

\maketitle

\section{Simulation and error metric} \label{sec:sim}
To verify the accuracy of \code{node.dating}, we applied it to simulated data.
we simulated 50 phylogenetic trees using a birth-death model with the the R package \emph{TreeSim} \citep{TreeSim}.
we then applied a strict molecular clock to trees wth the R package \emph{NELSI} \citep{NELSI}.
we used these trees to generate simulated HIV sequences with \emph{INDELible} 1.03 \citep{Indelible09}.
Finally we reconstructed phylogenetic trees from the sequences using \emph{RAxML} 8.2.4 \citep{Raxml14} and rooted the trees using the \code{rtt} function of the APE package.
This process is engineered to replicate phylogenetic trees derived from real data.

The dates of the MRCA of each pair of tips of the original birth-death tree were saved and compared with the results of \code{node.dating} using a weighted root mean squared error (RMSE) as the error metric.
Specifically:
\[\operatorname{RMSE} = \sqrt{\frac{\sum_{1 \leq i < j \leq N}w_{i,j}\left(d_{\operatorname{MRCA}_{t_r}(i,j)} - \delta_{\operatorname{MRCA}_{t_p}(i,j)}\right)^2}{\sum_{1 \leq i < j \leq N}w_{i,j}}}\]
where $t_r$ and $t_p$ are the real (resp.~predicted) phylogenies each with $N$ tips; $\operatorname{MRCA}_t(i, j)$ is the MRCA of tip $i$ and $j$ in the phyolgeny, $t$; $d_{m}$ and $\delta_m$ are the real (resp.~predicted) dates of the MRCA, $m$; and $w_{i, j}$ is the weight of the pair of tips, $i$ and $j$, and is given by:
\[w_{i, j} = \sqrt{\nicefrac{1}{\left(x_{\operatorname{MRCA}_{t_r}(i,j)}y_{\operatorname{MRCA}_{t_p}(i,j)}\right)}}\]
with $x_m$ and $y_m$ as the number of pairs of tips in the real (resp.~predicted) phylogeny whose MRCA is $m$.
The MRCA was compared instead of then date of each internal node because the tree topologies may change after applying \emph{RAxML}.

\bibliographystyle{natbib}
\bibliography{node.dating}

\end{document}